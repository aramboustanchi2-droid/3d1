[
  {
    "timestamp": "2025-11-21T22:57:10.400Z",
    "fileName": "test_meta_controller.py",
    "content": "\"\"\"\r\nTest Meta-Controller Intelligence\r\n\r\nآزمایش سیستم Meta-Controller برای انتخاب هوشمند روش AI\r\n\"\"\"\r\n\r\nimport io\r\nimport sys\r\nimport os\r\n\r\n# Fix Unicode encoding for Windows\r\nsys.stdout = io.TextIOWrapper(sys.stdout.buffer, encoding='utf-8')\r\nsys.path.append(os.path.dirname(os.path.dirname(__file__)))\r\n\r\nfrom cad3d.super_ai.unified_ai_system import (\r\n    UnifiedAISystem,\r\n    AITaskType\r\n)\r\n\r\nprint(\"\\n\" + \"=\"*80)\r\nprint(\"  META-CONTROLLER INTELLIGENCE TEST\")\r\nprint(\"=\"*80 + \"\\n\")\r\n\r\n# Initialize\r\nprint(\"Step 1: Initializing Unified AI System with Meta-Controller...\")\r\nunified = UnifiedAISystem()\r\nprint(\"✓ System initialized\\n\")\r\n\r\n# Check Meta-Controller status\r\nstatus = unified.get_system_status()\r\nif status.get('meta_controller'):\r\n    print(\"✓ Meta-Controller is active\")\r\n    print(f\"  Performance Stats:\")\r\n    for method, stats in status['meta_controller'].items():\r\n        print(f\"    {method}: Success={stats['success_rate']}, AvgTime={stats['avg_time']}\")\r\nelse:\r\n    print(\"✗ Meta-Controller not available\")\r\n\r\nprint(\"\\n\" + \"=\"*80)\r\nprint(\"  TEST 1: Simple Calculation (Fast Response)\")\r\nprint(\"=\"*80)\r\n\r\nquery1 = \"محاسبه مساحت اتاق 5 در 4 متر\"\r\nprint(f\"\\nQuery: {query1}\")\r\nprint(\"Expected: RAG (fast, accurate for calculations)\")\r\n\r\n# Get explanation before execution\r\nexplanation1 = unified.explain_selection(query1, AITaskType.ARCHITECTURAL_DESIGN)\r\nprint(f\"\\nSelected Method: {explanation1['selected_method']}\")\r\nprint(f\"Reasoning: {explanation1['reasoning']}\")\r\nprint(f\"Features:\")\r\nprint(f\"  - Complexity: {explanation1['features']['complexity']}\")\r\nprint(f\"  - Domain: {explanation1['features']['domain']}\")\r\nprint(f\"  - Confidence Needed: {explanation1['features']['confidence_needed']}\")\r\nprint(f\"Scores:\")\r\nprint(f\"  - Speed: {explanation1['scores']['speed']}\")\r\nprint(f\"  - Accuracy: {explanation1['scores']['accuracy']}\")\r\nprint(f\"  - Cost: {explanation1['scores']['cost']}\")\r\n\r\n# Execute query\r\nresponse1 = unified.query(query1, task_type=AITaskType.ARCHITECTURAL_DESIGN)\r\nprint(f\"\\nActual Method: {response1['method']}\")\r\nprint(f\"Status: {response1['status']}\")\r\nif 'selection_reasoning' in response1:\r\n    print(f\"Controller: {response1['selection_reasoning']['controller']}\")\r\n\r\nprint(\"\\n\" + \"=\"*80)\r\nprint(\"  TEST 2: Complex Analysis (Specialized)\")\r\nprint(\"=\"*80)\r\n\r\nquery2 = \"تحلیل و بهینه‌سازی طراحی ساختار سازه‌ای یک ساختمان 10 طبقه با در نظر گرفتن ضوابط ملی\"\r\nprint(f\"\\nQuery: {query2}\")\r\nprint(\"Expected: Fine-Tuning (complex, specialized, high accuracy needed)\")\r\n\r\nexplanation2 = unified.explain_selection(query2, AITaskType.STRUCTURAL_CALCULATION)\r\nprint(f\"\\nSelected Method: {explanation2['selected_method']}\")\r\nprint(f\"Reasoning: {explanation2['reasoning']}\")\r\nprint(f\"Features:\")\r\nprint(f\"  - Complexity: {explanation2['features']['complexity']}\")\r\nprint(f\"  - Domain: {explanation2['features']['domain']}\")\r\nprint(f\"  - Requires Knowledge: {explanation2['features']['requires_knowledge']}\")\r\nprint(f\"  - Specialized: {explanation2['features']['is_specialized']}\")\r\nprint(f\"Scores: Speed={explanation2['scores']['speed']}, Accuracy={explanation2['scores']['accuracy']}\")\r\n\r\nresponse2 = unified.query(query2, task_type=AITaskType.STRUCTURAL_CALCULATION)\r\nprint(f\"\\nActual Method: {response2['method']}\")\r\nprint(f\"Status: {response2['status']}\")\r\n\r\nprint(\"\\n\" + \"=\"*80)\r\nprint(\"  TEST 3: Quick General Question\")\r\nprint(\"=\"*80)\r\n\r\nquery3 = \"پیشنهاد برای چیدمان فضای نشیمن\"\r\nprint(f\"\\nQuery: {query3}\")\r\nprint(\"Expected: Prompt Engineering (simple, fast, general)\")\r\n\r\nexplanation3 = unified.explain_selection(query3)\r\nprint(f\"\\nSelected Method: {explanation3['selected_method']}\")\r\nprint(f\"Reasoning: {explanation3['reasoning']}\")\r\nprint(f\"Features:\")\r\nprint(f\"  - Complexity: {explanation3['features']['complexity']}\")\r\nprint(f\"  - Domain: {explanation3['features']['domain']}\")\r\n\r\nresponse3 = unified.query(query3)\r\nprint(f\"\\nActual Method: {response3['method']}\")\r\nprint(f\"Status: {response3['status']}\")\r\n\r\nprint(\"\\n\" + \"=\"*80)\r\nprint(\"  TEST 4: Technical MEP Query\")\r\nprint(\"=\"*80)\r\n\r\nquery4 = \"محاسبه ظرفیت لوله‌کشی فاضلاب برای ساختمان\"\r\nprint(f\"\\nQuery: {query4}\")\r\nprint(\"Expected: LoRA or PEFT (specialized domain, moderate complexity)\")\r\n\r\nexplanation4 = unified.explain_selection(query4, AITaskType.MEP_OPTIMIZATION)\r\nprint(f\"\\nSelected Method: {explanation4['selected_method']}\")\r\nprint(f\"Reasoning: {explanation4['reasoning']}\")\r\nprint(f\"Features:\")\r\nprint(f\"  - Complexity: {explanation4['features']['complexity']}\")\r\nprint(f\"  - Domain: {explanation4['features']['domain']}\")\r\n\r\nif 'alternatives' in explanation4:\r\n    print(f\"\\nTop 3 Alternatives:\")\r\n    for alt in explanation4['alternatives']:\r\n        print(f\"  {alt['method']}: score={alt['score']} - {alt['reasoning']}\")\r\n\r\nresponse4 = unified.query(query4, task_type=AITaskType.MEP_OPTIMIZATION)\r\nprint(f\"\\nActual Method: {response4['method']}\")\r\nprint(f\"Status: {response4['status']}\")\r\n\r\nprint(\"\\n\" + \"=\"*80)\r\nprint(\"  TEST 5: PEFT Adapter Query\")\r\nprint(\"=\"*80)\r\n\r\nquery5 = \"use peft prefix-tuning adapter for architectural analysis\"\r\nprint(f\"\\nQuery: {query5}\")\r\nprint(\"Expected: PEFT (explicit keyword)\")\r\n\r\nexplanation5 = unified.explain_selection(query5)\r\nprint(f\"\\nSelected Method: {explanation5['selected_method']}\")\r\nprint(f\"Reasoning: {explanation5['reasoning']}\")\r\n\r\nresponse5 = unified.query(query5)\r\nprint(f\"\\nActual Method: {response5['method']}\")\r\nprint(f\"Status: {response5['status']}\")\r\n\r\nprint(\"\\n\" + \"=\"*80)\r\nprint(\"  PERFORMANCE SUMMARY\")\r\nprint(\"=\"*80)\r\n\r\nfinal_status = unified.get_system_status()\r\nif final_status.get('meta_controller'):\r\n    print(\"\\nMeta-Controller Performance (Updated):\")\r\n    for method, stats in final_status['meta_controller'].items():\r\n        print(f\"  {method}:\")\r\n        print(f\"    Success Rate: {stats['success_rate']}\")\r\n        print(f\"    Avg Time: {stats['avg_time']}\")\r\n\r\nstats = final_status['usage_statistics']\r\nprint(f\"\\nTotal Queries: {stats['total_queries']}\")\r\nprint(f\"  RAG: {stats['rag_calls']}\")\r\nprint(f\"  Fine-Tuning: {stats['fine_tuning_calls']}\")\r\nprint(f\"  LoRA: {stats['lora_calls']}\")\r\nprint(f\"  Prompt Engineering: {stats['prompt_calls']}\")\r\nprint(f\"  PEFT: {stats['peft_calls']}\")\r\n\r\nprint(\"\\n\" + \"=\"*80)\r\nprint(\"  SUCCESS!\")\r\nprint(\"=\"*80)\r\nprint(\"\\nMeta-Controller Features Demonstrated:\")\r\nprint(\"  ✓ Query complexity analysis\")\r\nprint(\"  ✓ Domain detection (architecture, structural, MEP)\")\r\nprint(\"  ✓ Confidence requirement assessment\")\r\nprint(\"  ✓ Multi-criteria scoring (speed, accuracy, cost)\")\r\nprint(\"  ✓ Performance tracking and learning\")\r\nprint(\"  ✓ Decision explanation\")\r\nprint(\"\\nIntelligent AI method selection is operational!\")\r\nprint(\"=\"*80 + \"\\n\")\r\n",
    "format": "py"
  },
  {
    "timestamp": "2025-11-21T22:57:21.079Z",
    "fileName": "test_meta_controller.py",
    "content": "\"\"\"\r\nTest Meta-Controller Intelligence\r\n\r\nآزمایش سیستم Meta-Controller برای انتخاب هوشمند روش AI\r\n\"\"\"\r\n\r\nimport io\r\nimport sys\r\nimport os\r\n\r\n# Fix Unicode encoding for Windows\r\nsys.stdout = io.TextIOWrapper(sys.stdout.buffer, encoding='utf-8')\r\nsys.path.append(os.path.dirname(os.path.dirname(__file__)))\r\n\r\nfrom cad3d.super_ai.unified_ai_system import (\r\n    UnifiedAISystem,\r\n    AITaskType\r\n)\r\n\r\nprint(\"\\n\" + \"=\"*80)\r\nprint(\"  META-CONTROLLER INTELLIGENCE TEST\")\r\nprint(\"=\"*80 + \"\\n\")\r\n\r\n# Initialize\r\nprint(\"Step 1: Initializing Unified AI System with Meta-Controller...\")\r\nunified = UnifiedAISystem()\r\nprint(\"✓ System initialized\\n\")\r\n\r\n# Check Meta-Controller status\r\nstatus = unified.get_system_status()\r\nif status.get('meta_controller'):\r\n    print(\"✓ Meta-Controller is active\")\r\n    print(f\"  Performance Stats:\")\r\n    for method, stats in status['meta_controller'].items():\r\n        print(f\"    {method}: Success={stats['success_rate']}, AvgTime={stats['avg_time']}\")\r\nelse:\r\n    print(\"✗ Meta-Controller not available\")\r\n\r\nprint(\"\\n\" + \"=\"*80)\r\nprint(\"  TEST 1: Simple Calculation (Fast Response)\")\r\nprint(\"=\"*80)\r\n\r\nquery1 = \"محاسبه مساحت اتاق 5 در 4 متر\"\r\nprint(f\"\\nQuery: {query1}\")\r\nprint(\"Expected: RAG (fast, accurate for calculations)\")\r\n\r\n# Get explanation before execution\r\nexplanation1 = unified.explain_selection(query1, AITaskType.ARCHITECTURAL_DESIGN)\r\nprint(f\"\\nSelected Method: {explanation1['selected_method']}\")\r\nprint(f\"Reasoning: {explanation1['reasoning']}\")\r\nprint(f\"Features:\")\r\nprint(f\"  - Complexity: {explanation1['features']['complexity']}\")\r\nprint(f\"  - Domain: {explanation1['features']['domain']}\")\r\nprint(f\"  - Confidence Needed: {explanation1['features']['confidence_needed']}\")\r\nprint(f\"Scores:\")\r\nprint(f\"  - Speed: {explanation1['scores']['speed']}\")\r\nprint(f\"  - Accuracy: {explanation1['scores']['accuracy']}\")\r\nprint(f\"  - Cost: {explanation1['scores']['cost']}\")\r\n\r\n# Execute query\r\nresponse1 = unified.query(query1, task_type=AITaskType.ARCHITECTURAL_DESIGN)\r\nprint(f\"\\nActual Method: {response1['method']}\")\r\nprint(f\"Status: {response1['status']}\")\r\nif 'selection_reasoning' in response1:\r\n    print(f\"Controller: {response1['selection_reasoning']['controller']}\")\r\n\r\nprint(\"\\n\" + \"=\"*80)\r\nprint(\"  TEST 2: Complex Analysis (Specialized)\")\r\nprint(\"=\"*80)\r\n\r\nquery2 = \"تحلیل و بهینه‌سازی طراحی ساختار سازه‌ای یک ساختمان 10 طبقه با در نظر گرفتن ضوابط ملی\"\r\nprint(f\"\\nQuery: {query2}\")\r\nprint(\"Expected: Fine-Tuning (complex, specialized, high accuracy needed)\")\r\n\r\nexplanation2 = unified.explain_selection(query2, AITaskType.STRUCTURAL_CALCULATION)\r\nprint(f\"\\nSelected Method: {explanation2['selected_method']}\")\r\nprint(f\"Reasoning: {explanation2['reasoning']}\")\r\nprint(f\"Features:\")\r\nprint(f\"  - Complexity: {explanation2['features']['complexity']}\")\r\nprint(f\"  - Domain: {explanation2['features']['domain']}\")\r\nprint(f\"  - Requires Knowledge: {explanation2['features']['requires_knowledge']}\")\r\nprint(f\"  - Specialized: {explanation2['features']['is_specialized']}\")\r\nprint(f\"Scores: Speed={explanation2['scores']['speed']}, Accuracy={explanation2['scores']['accuracy']}\")\r\n\r\nresponse2 = unified.query(query2, task_type=AITaskType.STRUCTURAL_CALCULATION)\r\nprint(f\"\\nActual Method: {response2['method']}\")\r\nprint(f\"Status: {response2['status']}\")\r\n\r\nprint(\"\\n\" + \"=\"*80)\r\nprint(\"  TEST 3: Quick General Question\")\r\nprint(\"=\"*80)\r\n\r\nquery3 = \"پیشنهاد برای چیدمان فضای نشیمن\"\r\nprint(f\"\\nQuery: {query3}\")\r\nprint(\"Expected: Prompt Engineering (simple, fast, general)\")\r\n\r\nexplanation3 = unified.explain_selection(query3)\r\nprint(f\"\\nSelected Method: {explanation3['selected_method']}\")\r\nprint(f\"Reasoning: {explanation3['reasoning']}\")\r\nprint(f\"Features:\")\r\nprint(f\"  - Complexity: {explanation3['features']['complexity']}\")\r\nprint(f\"  - Domain: {explanation3['features']['domain']}\")\r\n\r\nresponse3 = unified.query(query3)\r\nprint(f\"\\nActual Method: {response3['method']}\")\r\nprint(f\"Status: {response3['status']}\")\r\n\r\nprint(\"\\n\" + \"=\"*80)\r\nprint(\"  TEST 4: Technical MEP Query\")\r\nprint(\"=\"*80)\r\n\r\nquery4 = \"محاسبه ظرفیت لوله‌کشی فاضلاب برای ساختمان\"\r\nprint(f\"\\nQuery: {query4}\")\r\nprint(\"Expected: LoRA or PEFT (specialized domain, moderate complexity)\")\r\n\r\nexplanation4 = unified.explain_selection(query4, AITaskType.MEP_OPTIMIZATION)\r\nprint(f\"\\nSelected Method: {explanation4['selected_method']}\")\r\nprint(f\"Reasoning: {explanation4['reasoning']}\")\r\nprint(f\"Features:\")\r\nprint(f\"  - Complexity: {explanation4['features']['complexity']}\")\r\nprint(f\"  - Domain: {explanation4['features']['domain']}\")\r\n\r\nif 'alternatives' in explanation4:\r\n    print(f\"\\nTop 3 Alternatives:\")\r\n    for alt in explanation4['alternatives']:\r\n        print(f\"  {alt['method']}: score={alt['score']} - {alt['reasoning']}\")\r\n\r\nresponse4 = unified.query(query4, task_type=AITaskType.MEP_OPTIMIZATION)\r\nprint(f\"\\nActual Method: {response4['method']}\")\r\nprint(f\"Status: {response4['status']}\")\r\n\r\nprint(\"\\n\" + \"=\"*80)\r\nprint(\"  TEST 5: PEFT Adapter Query\")\r\nprint(\"=\"*80)\r\n\r\nquery5 = \"use peft prefix-tuning adapter for architectural analysis\"\r\nprint(f\"\\nQuery: {query5}\")\r\nprint(\"Expected: PEFT (explicit keyword)\")\r\n\r\nexplanation5 = unified.explain_selection(query5)\r\nprint(f\"\\nSelected Method: {explanation5['selected_method']}\")\r\nprint(f\"Reasoning: {explanation5['reasoning']}\")\r\n\r\nresponse5 = unified.query(query5)\r\nprint(f\"\\nActual Method: {response5['method']}\")\r\nprint(f\"Status: {response5['status']}\")\r\n\r\nprint(\"\\n\" + \"=\"*80)\r\nprint(\"  PERFORMANCE SUMMARY\")\r\nprint(\"=\"*80)\r\n\r\nfinal_status = unified.get_system_status()\r\nif final_status.get('meta_controller'):\r\n    print(\"\\nMeta-Controller Performance (Updated):\")\r\n    for method, stats in final_status['meta_controller'].items():\r\n        print(f\"  {method}:\")\r\n        print(f\"    Success Rate: {stats['success_rate']}\")\r\n        print(f\"    Avg Time: {stats['avg_time']}\")\r\n\r\nstats = final_status['usage_statistics']\r\nprint(f\"\\nTotal Queries: {stats['total_queries']}\")\r\nprint(f\"  RAG: {stats['rag_calls']}\")\r\nprint(f\"  Fine-Tuning: {stats['fine_tuning_calls']}\")\r\nprint(f\"  LoRA: {stats['lora_calls']}\")\r\nprint(f\"  Prompt Engineering: {stats['prompt_calls']}\")\r\nprint(f\"  PEFT: {stats['peft_calls']}\")\r\n\r\nprint(\"\\n\" + \"=\"*80)\r\nprint(\"  SUCCESS!\")\r\nprint(\"=\"*80)\r\nprint(\"\\nMeta-Controller Features Demonstrated:\")\r\nprint(\"  ✓ Query complexity analysis\")\r\nprint(\"  ✓ Domain detection (architecture, structural, MEP)\")\r\nprint(\"  ✓ Confidence requirement assessment\")\r\nprint(\"  ✓ Multi-criteria scoring (speed, accuracy, cost)\")\r\nprint(\"  ✓ Performance tracking and learning\")\r\nprint(\"  ✓ Decision explanation\")\r\nprint(\"\\nIntelligent AI method selection is operational!\")\r\nprint(\"=\"*80 + \"\\n\")\r\n",
    "format": "py"
  }
]